UPDATE foods SET product_weight_unit = (CASE WHEN REGEXP_LIKE(product_weight, '[a-zA-Z]+$') THEN REGEXP_SUBSTR(product_weight, '[a-zA-Z]+$') WHEN serving_size_unit <> '' THEN serving_size_unit ELSE product_weight_unit END), product_weight_value = (CASE WHEN REGEXP_LIKE(product_weight, '^[0-9.]+') THEN CAST(REGEXP_SUBSTR(product_weight, '^[0-9.]+') AS DECIMAL(10,2)) ELSE product_weight_value END);
